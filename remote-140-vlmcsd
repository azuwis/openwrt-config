oc_service enable vlmcsd
oc_service start vlmcsd

set_srvhost() {
    local hostname=$(uci -q get system.@system[0].hostname)
    local domain=$(uci -q get dhcp.@dnsmasq[0].domain)
    oc_uci_del_type dhcp srvhost
    uci add dhcp srvhost >/dev/null
    uci set "dhcp.@srvhost[0].srv=_vlmcs._tcp.${domain}"
    uci set "dhcp.@srvhost[0].target=${hostname}.${domain}"
    uci set "dhcp.@srvhost[0].port=1688"
    uci set "dhcp.@srvhost[0].class=0"
    uci set "dhcp.@srvhost[0].weight=100"
}
set_srvhost
oc_service reload dnsmasq dhcp
